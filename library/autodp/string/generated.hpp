#pragma once
#include <bits/stdc++.h>
using namespace std;

template <class VTYPE>
VTYPE solvedp(const string &s) {
	constexpr int DIM = 8;
	constexpr int COL = 9;
	VTYPE matAs[COL][DIM][DIM] = {{{0,1,0,0,0,0,0,0},{-1,2,0,0,0,0,0,0},{-1,1,1,0,0,0,0,0},{-1,1,0,1,0,0,0,0},{-1,1,0,0,1,0,0,0},{-1,1,0,0,0,1,0,0},{-1,1,0,0,0,0,1,0},{-1,1,0,0,0,0,0,1}},{{0,0,1,0,0,0,0,0},{-1,1,1,0,0,0,0,0},{-1,0,2,0,0,0,0,0},{-1,0,1,1,0,0,0,0},{-1,0,1,0,1,0,0,0},{-1,0,1,0,0,1,0,0},{-1,0,1,0,0,0,1,0},{-1,0,1,0,0,0,0,1}},{{0,0,0,1,0,0,0,0},{-1,1,0,1,0,0,0,0},{-1,0,1,1,0,0,0,0},{-1,0,0,2,0,0,0,0},{-1,0,0,1,1,0,0,0},{-1,0,0,1,0,1,0,0},{-1,0,0,1,0,0,1,0},{-1,0,0,1,0,0,0,1}},{{1,0,0,0,0,0,0,0},{0,0,0,0,1,0,0,0},{0,-1,1,0,0,1,0,0},{0,-1,0,1,0,0,1,0},{0,-1,0,0,2,0,0,0},{0,-1,0,0,1,1,0,0},{0,-1,0,0,1,0,1,0},{0,-1,0,0,1,0,0,1}},{{1,0,0,0,0,0,0,0},{0,0,0,0,0,1,0,0},{0,-4,1,0,14,-2,-8,0},{0,-6,0,1,21,-3,-12,0},{0,-1,0,0,1,1,0,0},{0,-1,0,0,0,2,0,0},{0,-1,0,0,0,1,1,0},{0,-1,0,0,0,1,0,1}},{{1,0,0,0,0,0,0,0},{0,0,0,0,0,0,1,0},{0,-6,1,0,21,-3,-12,0},{0,-2,0,1,7,-1,-4,0},{0,-1,0,0,1,0,1,0},{0,-1,0,0,0,1,1,0},{0,-1,0,0,0,0,2,0},{0,-1,0,0,0,0,1,1}},{{1,0,0,0,0,0,0,0},{0,1,0,0,0,0,0,0},{0,0,1,0,0,0,0,0},{0,0,0,1,0,0,0,0},{0,0,0,0,0,0,0,1},{0,0,0,0,-2,1,0,2},{0,0,0,0,-1,0,1,1},{0,0,0,0,-1,0,0,2}},{{1,0,0,0,0,0,0,0},{0,1,0,0,0,0,0,0},{0,0,1,0,0,0,0,0},{0,0,0,1,0,0,0,0},{0,0,0,0,-1,0,0,2},{0,0,0,0,-2,1,0,2},{0,0,0,0,-3,0,1,3},{0,0,0,0,-2,0,0,3}},{{1,0,0,0,0,0,0,0},{0,1,0,0,0,0,0,0},{0,0,1,0,0,0,0,0},{0,0,0,1,0,0,0,0},{0,0,0,0,0,0,0,1},{0,0,0,0,-3,1,0,3},{0,0,0,0,-1,0,1,1},{0,0,0,0,-1,0,0,2}}};
	VTYPE vecQ[DIM] = {0,0,0,0,0,0,0,1};
	array<VTYPE, DIM> dp;
	dp[0] = 1;
	for (int i=1; i<DIM; i++) dp[i] = 0;
	auto apply = [&](const array<VTYPE, DIM> &x, int col) {
		array<VTYPE, DIM> z;
		for (int j=0; j<DIM; j++) {
			z[j] = 0;
			for (int i=0; i<DIM; i++) z[j] += x[i]*matAs[col][i][j];
		}
		return z;
	};
	for (const auto &c : s) dp = apply(dp, c-'0');
	VTYPE res = 0;
	for (int i=0; i<DIM; i++) res += vecQ[i]*dp[i];
	return res;
}

